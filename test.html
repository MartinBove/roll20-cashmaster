<html>
<head>
<script type="text/javascript">

function cm_changemoney(startamount,addamount)
	{
		if (addamount !== null) {
		var currency=addamount.slice(-2);
		var amount2=-parseInt(addamount.substr(0,addamount.length-2));
		var origamount=startamount;
		var amount3=0;
		if (currency=="cp") amount3=amount2/100;
		if (currency=="sp") amount3=amount2/10;
		if (currency=="ep") amount3=amount2/2;
		if (currency=="gp") amount3=amount2;
		if (currency=="pp") amount3=amount2*10;
		if (startamount[0]*10+startamount[1]+startamount[2]/2+startamount[3]/10+startamount[4]/100>-amount3) 
		{
			startamount[4]+=amount3*100;		
			while (startamount[4]<0) {startamount[4]+=10;startamount[3]--;} //cp
			while (startamount[3]<0) {if (startamount[4]>10) {startamount[4]-=10;startamount[3]++} else {startamount[3]+=5;startamount[2]--;}} //sp
			while (startamount[2]<0) {if (startamount[3]>5) {startamount[3]-=5;  startamount[4]++} else {startamount[2]+=2;startamount[1]--;}}   //ep
			while (startamount[1]<0) {if (startamount[2]>2) {startamount[2]-=2;  startamount[1]++} else {startamount[1]+=10;startamount[0]--;}} //gp
			while (startamount[0]<0) {if (startamount[1]>10) {startamount[1]-=10;  startamount[0]++} else {startamount=origamount;return "ERROR: Not enough cash.";}} //pp
			return startamount;
		}
		else return "ERROR: Not enough cash.";
		}
	}


var test1=[0,5,0,0,5000];
var test2=["1pp","5gp","500pp","1cp","77sp"];

for(i=0;i<test2.length;i++)
{
document.writeln("Taking "+test2[i]+" from "+test1+": ");
document.writeln(cm_changemoney(test1,test2[i]));
document.writeln(": <b>"+(test1[0]*10+test1[1]+test1[2]/2+test1[3]/10+test1[4]/100)+"</b>");
document.writeln("<p>");
}



</script>
</head>
<body>

</body>
</html>